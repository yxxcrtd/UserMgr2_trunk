$(function(){$(document).bind("contextmenu",function(e){return false});$("#username").focus()});function loadNext(divout,divin,step){var loadImgNode=$(".loadImg");loadImgNode.show();var usernameNode=$("#username");var usernameValue=$.trim(usernameNode.val());var usernameTipNode=$("#usernameTip");usernameTipNode.hide();var questionNode=$("#question");var answerNode=$("#answer");var answerValue=$.trim(answerNode.val());var answerTipNode=$("#answerTip");answerTipNode.hide();var passwordNode=$("#password");var passwordValue=passwordNode.val();var passwordTipNode=$("#passwordTip");passwordTipNode.hide();var repasswordNode=$("#repassword");var repasswordValue=repasswordNode.val();var repasswordTipNode=$("#repasswordTip");repasswordTipNode.hide();if(step=="1"){if(usernameValue==""){usernameNode.addClass("mustInput");usernameNode.focus();loadImgNode.hide();usernameTipNode.show().html("用户名/Email不能为空！");return}else{$.post("find.action",{cmd:"verify",username:usernameValue},function(response){loadImgNode.hide();if(response=="null"){usernameNode.addClass("mustInput");usernameNode.focus();usernameTipNode.show().html("该用户没有设置找回密码的问题和答案！");return}if(response=="error"){usernameNode.addClass("mustInput");usernameNode.focus();usernameTipNode.show().html("用户不存在！");return}else{$("."+divout).hide();$("."+divin).fadeIn("fast");answerNode.val("");questionNode.show().html(response)}})}}if(step=="2"){if(answerValue==""){answerNode.addClass("mustInput");answerNode.focus();loadImgNode.hide();answerTipNode.show().html("问题答案不能为空！");return}else{$.post("find.action",{cmd:"answer",username:usernameValue,answer:answerValue},function(response){loadImgNode.hide();if(response=="error"){answerNode.addClass("mustInput");answerNode.focus();answerTipNode.show().html("问题答案不正确！");return}else{$("."+divout).hide();$("."+divin).fadeIn("fast");answerNode.removeClass("mustInput")}})}}if(step=="3"){if(passwordValue==""){passwordNode.addClass("mustInput");passwordNode.focus();loadImgNode.hide();passwordTipNode.show().html("新密码不能为空！");return}else{passwordNode.removeClass("mustInput")}if(repasswordValue==""){repasswordNode.addClass("mustInput");repasswordNode.focus();loadImgNode.hide();repasswordTipNode.show().html("确认新密码不能为空！");return}else{repasswordNode.removeClass("mustInput")}if(passwordValue.length<5||passwordValue.length>25){passwordNode.addClass("mustInput");repasswordNode.addClass("mustInput");passwordNode.focus();loadImgNode.hide();passwordTipNode.show().html("密码的长度范围必须在5-25之间！");return}if(passwordValue!=repasswordValue){passwordNode.addClass("mustInput");repasswordNode.addClass("mustInput");passwordNode.focus();loadImgNode.hide();passwordTipNode.show().html("两个密码不一致！");return}else{$.post("find.action",{cmd:"reset",username:usernameValue,answer:answerValue,password:passwordValue},function(response){loadImgNode.hide();if(response=="success"){alert("密码重置成功，请牢记您的新密码！");$("."+divout).hide();$("."+divin).fadeIn("fast");passwordNode.val("");repasswordNode.val("");usernameNode.val("");usernameNode.removeClass("mustInput")}else{alert("操作失败！");return}})}}};